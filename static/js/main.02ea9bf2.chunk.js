(this["webpackJsonpmatrix-profile-web"]=this["webpackJsonpmatrix-profile-web"]||[]).push([[0],{191:function(e,t,n){},192:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),i=n(60),l=n.n(i),r=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,197)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,l=t.getTTFB;n(e),a(e),c(e),i(e),l(e)}))},s=n(6),o=n.n(s),u=n(13),d=n(38),m=n(3),j=n(66),b=n(62);var f,h,x=function(e,t,n){return e<t?t:e>n?n:e},v=Object(b.a)(new function(){return new Worker(n.p+"static/js/wasm.worker.6b4c3841.worker.js")});!function(e){e[e.Empty=0]="Empty",e[e.SampleData=1]="SampleData",e[e.SelectColumn=2]="SelectColumn",e[e.CustomData=3]="CustomData",e[e.Error=4]="Error"}(f||(f={})),function(e){e[e.Empty=0]="Empty",e[e.Loading=1]="Loading",e[e.Finished=2]="Finished"}(h||(h={}));var p=function(e){return e.value},O={lastWindowSize:void 0,calcState:h.Empty,profile:void 0,profileIdxs:void 0},w={filename:void 0,csvData:void 0,csvColumns:void 0,selectedColumn:void 0},S=Object(j.a)((function(e,t){return{windowSize:50,dataState:f.Empty,calcState:h.Empty,setData:function(t){return e({data:t})},setWindowSize:function(t){return e({windowSize:t})},selectColumn:function(t){e((function(e){var n=e.csvData;return void 0===n?{dataState:f.Error}:{data:n.map((function(e){var n;return{value:+(null!==(n=e[t])&&void 0!==n?n:"")}})),selectedColumn:t,dataState:f.CustomData}}))},loadSampleData:function(){var t=Object(d.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.c)("accident_UK.csv",(function(e){return{value:+e.Total_Accident}}));case 2:n=t.sent,e(Object(u.a)(Object(u.a)({data:n,dataState:f.SampleData},O),w));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),uploadData:function(n,a){var c=void 0===a?"":function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.split("\\"),a=n[n.length-1];return t&&(a=a.split(".csv")[0]),a}(a),i=Object(m.d)(n),l=i.columns;e(Object(u.a)({filename:c,csvData:i,csvColumns:l,data:void 0,dataState:f.SelectColumn,selectedColumn:void 0},O)),t().selectColumn(l[0])},calculate:function(){var n=Object(d.a)(o.a.mark((function n(){var a,c,i,l,r,s;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e({calcState:h.Loading}),void 0!==(a=t().data)){n.next=4;break}return n.abrupt("return");case 4:return c=t().windowSize,i=Float32Array.from(a.map(p)),n.next=8,v.calculate(i,c);case 8:l=n.sent,r=l.profileIdxs,s=l.profile,e({profileIdxs:r,profile:s,calcState:h.Finished,lastWindowSize:c});case 12:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()}})),g=n(0),y=function(e){return{loadSampleData:e.loadSampleData,dataState:e.dataState,calcState:e.calcState}},C=function(){var e=S(y),t=e.loadSampleData,n=e.dataState,c=e.calcState,i=Object(a.useMemo)((function(){return n===f.SampleData||c===h.Loading}),[c,n]);return Object(g.jsx)("button",{className:"btn",onClick:t,disabled:i,children:"Load sample"})},N=n(2),k=n(68),z=n(30),M=n(56),D=n(67),A=function(e){return{profile:e.profile,calcState:e.calcState,filename:e.filename}},L=function(e){var t=e.className,n=S(A),c=n.profile,i=n.calcState,l=n.filename,r=Object(a.useState)(""),s=Object(N.a)(r,2),o=s[0],u=s[1],d=Object(a.useMemo)((function(){return i===h.Loading}),[i]),m=Object(a.useMemo)((function(){return void 0===l?"matrix_profile.csv":l.split(".csv")[0]+"_profile.csv"}),[l]),j=Object(a.useCallback)((function(){return!d&&(u("matrix_profile\n"+(null!==c&&void 0!==c?c:[]).join("\n")),!0)}),[d,c]);return Object(g.jsx)(D.CSVLink,{data:o,filename:m,onClick:j,className:t,children:Object(g.jsx)("button",{className:"btn text-base",disabled:d,children:"Download result"})})},B=Object(a.forwardRef)((function(e,t){var n=e.y,c=e.yLength,i=e.margins,l=e.height,r=e.width,s=e.children,o=e.limits,u=e.title,d=e.className,j=e.refB,b=e.windowSize,f=e.windowSizeB,h=e.brushClassName,x=e.showYAxis,v=void 0===x||x,p=e.cursorBrush,O=void 0!==p&&p,w=l-i.top-i.bottom,S=r-i.left-i.right,y=Object(a.useMemo)((function(){return null===o?{x:[0,null!==c&&void 0!==c?c:n.length],yShow:n}:{x:[o[0],o[1]],yShow:n.slice(o[0],o[1])}}),[o,n,c]),C=y.x,N=y.yShow,k=Object(a.useMemo)((function(){var e=C,t=[i.left,r-i.right],n=Object(m.g)().domain(e).range(t);return{xAxis:Object(m.a)(n).tickSize(5).tickSizeOuter(0),xScale:n}}),[i.left,i.right,r,C]),z=k.xAxis,M=k.xScale,D=Object(a.useMemo)((function(){var e=Object(m.e)(n).map((function(e){return null!==e&&void 0!==e?e:0})),t=[l-i.bottom,i.top],a=Object(m.g)().domain(e).range(t).nice();return{yScale:a,yAxis:Object(m.b)(a).tickSize(-S).ticks(4)}}),[n,l,i,S]),A=D.yAxis,L=D.yScale,B=Object(a.useMemo)((function(){return void 0!==N?Object(m.f)()(N.map((function(e,t){return[M(t+C[0]),L(e)]}))):null}),[N,M,L,C]),E=Object(a.useCallback)((function(e){Object(m.h)(e).call(z)}),[z]),W=Object(a.useCallback)((function(e){v&&Object(m.h)(e).transition().call(A)}),[v,A]),F=Object(a.useMemo)((function(){return Math.abs(M(0)-M(null!==b&&void 0!==b?b:0))}),[b,M]),R=Object(a.useMemo)((function(){return Math.abs(M(0)-M(null!==f&&void 0!==f?f:0))}),[f,M]),T=Object(a.useCallback)((function(e){var n=e.clientX,a=e.target,c=t;if(null!==c.current){var i=a.getBoundingClientRect(),l=i.x,r=i.width,s=n-l,o=Math.min(r-s,F);if(c.current.setAttribute("x",""+s),c.current.setAttribute("width",""+o),void 0!==j&&null!==j.current){var u=Math.min(r-s,R);j.current.setAttribute("x",""+s),j.current.setAttribute("width",""+u)}}}),[t,j,F,R]),_=Object(a.useCallback)((function(){var e=t;null!==e.current&&(e.current.setAttribute("width","0"),void 0!==j&&null!==j.current&&j.current.setAttribute("width","0"))}),[t,j]);return Object(g.jsx)("div",{className:"bg-indigo-50 rounded-sm",children:Object(g.jsxs)("svg",{height:l,width:r,children:[Object(g.jsx)("rect",{className:"fill-current text-white",transform:"translate(".concat(i.left,",").concat(i.top,")"),width:S,height:w}),void 0!==u?Object(g.jsx)("text",{className:"text-current text-2xl",transform:"translate(".concat(i.left+5,", ").concat(i.top-10,")"),children:u}):null,Object(g.jsx)("g",{ref:E,transform:"translate(0,".concat(l-i.bottom,")")}),Object(g.jsx)("g",{ref:W,transform:"translate(".concat(i.left,",0)")}),null!==B?Object(g.jsx)("path",{fill:"none",className:d,d:B}):null,s,O?Object(g.jsxs)("g",{transform:"translate(".concat(i.left,",").concat(i.top,")"),children:[Object(g.jsx)("rect",{ref:t,className:h,height:w}),Object(g.jsx)("rect",{className:"opacity-0",width:S,height:w,onPointerMove:T,onPointerLeave:_})]}):null]})})})),E=function(e){var t=e.y,n=e.profile,c=e.height,i=e.width,l=e.margins,r=e.setLimits,s=Object(a.useMemo)((function(){var e=[0,t.length],n=[l.left,i-l.right];return Object(m.g)().domain(e).range(n)}),[t.length,l.left,l.right,i]),o=Object(a.useCallback)((function(e){var t=e.selection,n=e.type;null===t?r(null):"end"!==n&&r(t.map(s.invert))}),[r,s]),u=Object(a.useMemo)((function(){var e=Object(z.a)().extent([[l.left,l.top],[i-l.right,c-l.bottom]]);return e.on("brush",o),e.on("end",o),e}),[l,i,c,o]),d=Object(a.useRef)(null),j=Object(a.useRef)(null),b=Object(a.useMemo)((function(){var e=Object(m.e)(null!==n&&void 0!==n?n:[0,100]).map((function(e){return null!==e&&void 0!==e?e:0})),t=[c-l.bottom,l.top];return Object(m.g)().domain(e).range(t).nice()}),[c,l,n]),f=Object(a.useMemo)((function(){return void 0!==n?Object(m.f)()(n.map((function(e,t){return[s(t),b(e)]}))):null}),[n,s,b]);return Object(a.useEffect)((function(){void 0!==u&&null!==d.current&&(Object(M.a)(d.current).call(u),null!==j.current&&Object(M.a)(j.current).call(u))}),[u,s,t.length,n]),Object(g.jsxs)("div",{className:"flex flex-col",children:[Object(g.jsxs)(B,{y:t,margins:l,height:c,width:i,limits:null,className:"stroke-current text-blue-900 stroke-2 text-opacity-80",showYAxis:!1,children:[null!==f?Object(g.jsx)("path",{fill:"none",className:"stroke-current text-red-900 stroke-2 text-opacity-80",d:f}):null,Object(g.jsx)("g",{ref:d})]}),null!==f?Object(g.jsx)(L,{className:"mt-2 ml-auto mr-2"}):null]})},W=function(e){return{csvColumns:e.csvColumns,selectColumn:e.selectColumn}},F=function(){var e=S(W),t=e.csvColumns,n=e.selectColumn,c=Object(a.useCallback)((function(e){var t=e.target;n(t.value)}),[n]);return void 0!==t?Object(g.jsxs)("div",{className:"flex",children:[Object(g.jsx)("p",{className:"font-medium",children:"Select column:"}),Object(g.jsx)("select",{className:"ml-2 py-0.5 rounded-md hover:shadow",onChange:c,children:t.map((function(e,t){return Object(g.jsx)("option",{value:e,children:e},t)}))})]}):null},R=function(e){return{data:e.data,profile:e.profile,windowSize:e.windowSize,dataState:e.dataState}},T={left:30,right:20,top:38,bottom:25},_=Object(u.a)(Object(u.a)({},T),{},{top:10}),I=100,P=200,U=50,V=120,J=function(){var e=Object(k.a)({polyfill:ResizeObserver}),t=Object(N.a)(e,2),n=t[0],c=t[1],i=c.height,l=c.width,r=S(R),s=r.data,o=r.profile,u=r.windowSize,d=r.dataState,m=Object(a.useState)(null),j=Object(N.a)(m,2),b=j[0],h=j[1],v=Object(a.useMemo)((function(){return null===s||void 0===s?void 0:s.map(p)}),[s]),O=void 0===o?i:i/2;O=x(O,I,P);var w=x(i-O,U,V),y=Object(a.useRef)(null),C=Object(a.useRef)(null);return Object(g.jsxs)("div",{ref:n,style:{minWidth:"300px"},className:"mt-4 flex flex-col flex-1",children:[Object(g.jsx)(F,{}),void 0!==v?Object(g.jsx)("div",{className:"mt-3",children:Object(g.jsx)(B,{ref:y,refB:C,y:v,margins:T,height:O,width:l,limits:b,title:"Time series data",className:"stroke-current text-blue-900 stroke-2 text-opacity-80",cursorBrush:!0,brushClassName:"fill-current text-blue-400 opacity-30",windowSize:u,windowSizeB:1})}):d===f.SelectColumn?Object(g.jsx)("div",{className:"mt-5 text-center",children:Object(g.jsx)("p",{children:"Select one column to plot."})}):Object(g.jsx)("div",{className:"mt-5 text-center",children:Object(g.jsx)("p",{children:"Upload some time series data or Load the sample data."})}),void 0!==o?Object(g.jsx)("div",{className:"mt-2",children:Object(g.jsx)(B,{ref:C,refB:y,y:o,yLength:null===v||void 0===v?void 0:v.length,margins:T,height:O,width:l,limits:b,title:"Matrix profile",className:"stroke-current text-red-900 stroke-2 text-opacity-80",cursorBrush:!0,brushClassName:"fill-current text-red-600 opacity-60 stroke-current stroke-1",windowSize:1,windowSizeB:u})}):null,void 0!==v?Object(g.jsx)("div",{className:"mt-2",children:Object(g.jsx)(E,{y:v,profile:o,margins:_,height:w,width:l,setLimits:h})}):null,void 0===o&&void 0!==v?Object(g.jsx)("div",{className:"mt-5 text-center",children:Object(g.jsx)("p",{children:'Use the "Calculate" button to compute the matrix profile.'})}):null]})},K=function(e){return{dataState:e.dataState,filename:e.filename}},Y=function(){var e=S(K),t=e.dataState,n=e.filename,a=null!==n&&void 0!==n?n:"custom_file";return t===f.SampleData||t===f.CustomData?Object(g.jsxs)("div",{className:"mt-4 text-base text-gray-700",children:[Object(g.jsx)("p",{className:"inline font-medium",children:"Data: "}),t===f.CustomData?Object(g.jsx)("p",{className:"inline",children:a}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("p",{className:"inline",children:Object(g.jsx)("a",{href:"https://www.kaggle.com/sadeghjalalian/road-accident-in-uk",target:"_black",rel:"noopener",children:"Road Accident in UK"})}),Object(g.jsx)("p",{className:"mt-1 font-light",children:"This data provides detailed road safety data about the circumstances of personal injury road accidents in GB from 2014 to 2017. The statistics relate only to personal injury accidents on public roads that are reported to the police, and subsequently recorded, using the STATS19 accident reporting form."})]})]}):null},q={sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5"},G=function(e){var t=e.className,n=e.size,a=q[void 0===n?"md":n];return Object(g.jsxs)("svg",{className:"animate-spin ".concat(a," ").concat(t),fill:"none",viewBox:"0 0 24 24",children:[Object(g.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),Object(g.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},H=function(e){return{dataState:e.dataState,calcState:e.calcState,windowSize:e.windowSize,lastWindowSize:e.lastWindowSize,calculate:e.calculate}},X=function(){var e=S(H),t=e.dataState,n=e.calcState,c=e.windowSize,i=e.lastWindowSize,l=e.calculate,r=Object(a.useMemo)((function(){var e=c===(null!==i&&void 0!==i?i:c),a=t===f.Empty||n!==h.Empty;return e&&a}),[n,t,i,c]);return Object(g.jsx)("button",{className:"btn",onClick:l,disabled:r,children:Object(g.jsxs)("div",{className:"flex items-baseline",children:["Calculate",n===h.Loading?Object(g.jsx)(G,{className:"ml-1"}):null]})})},Q=function(e){return{windowSize:e.windowSize,calcState:e.calcState,setWindowSize:e.setWindowSize}},Z=function(){var e=S(Q),t=e.windowSize,n=e.calcState,c=e.setWindowSize,i=Object(a.useCallback)((function(e){var t=e.target;return c(+t.value)}),[c]);return Object(g.jsxs)("div",{className:"flex items-baseline",children:[Object(g.jsx)("p",{className:"font-medium",children:"Window size:"}),Object(g.jsx)("input",{type:"number",min:0,step:5,disabled:n===h.Loading,defaultValue:t,onChange:i,className:"ml-2 w-20 md:w-28 py-0.5 rounded-md border focus:border-gray-600 hover:shadow text-center"})]})},$=function(e){return{calcState:e.calcState,uploadData:e.uploadData}},ee=function(){var e=S($),t=e.calcState,n=e.uploadData,c=Object(a.useRef)(null),i=Object(a.useMemo)((function(){return t===h.Loading}),[t]),l=Object(a.useMemo)((function(){var e=new FileReader;return e.onload=function(){var t,a=null===(t=c.current)||void 0===t?void 0:t.value;n(e.result,a),null!==c.current&&(c.current.value="")},e}),[n]),r=Object(a.useCallback)((function(e){var t=e.target;null!==t.files&&void 0!==t.files[0]&&l.readAsText(t.files[0])}),[l]),s=Object(a.useCallback)((function(){null!==c.current&&c.current.click()}),[]);return Object(g.jsxs)("div",{children:[Object(g.jsx)("input",{ref:c,type:"file",className:"hidden pointer-events-none",accept:".csv",onChange:r}),Object(g.jsx)("button",{className:"btn",onClick:s,disabled:i,children:"Upload data"})]})},te=function(){return Object(g.jsxs)("div",{className:"flex flex-col container mx-auto px-10 pt-6 min-h-screen",children:[Object(g.jsx)("p",{className:"text-5xl font-bold",children:"Matrix Profile"}),Object(g.jsxs)("div",{className:"mt-8 pr-4 flex flex-col sm:flex-row flex-wrap justify-between",children:[Object(g.jsx)(Z,{}),Object(g.jsxs)("div",{className:"mt-2 sm:mt-0 flex space-x-2",children:[Object(g.jsx)(ee,{}),Object(g.jsx)(C,{}),Object(g.jsx)(X,{})]})]}),Object(g.jsx)(Y,{}),Object(g.jsx)(J,{})]})};n(191);l.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(te,{})}),document.getElementById("root")),r()}},[[192,1,2]]]);
//# sourceMappingURL=main.02ea9bf2.chunk.js.map